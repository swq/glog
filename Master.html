<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="spreadjs culture" content="zh-cn" />
    <title>提料管理系统 | 开发版</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link href="Content/font-awesome/font-awesome.min.css" rel="stylesheet" />
    <!-- Ionicons -->

    <!-- Theme style -->
    <link href="Content/AdminLTE.min.css" rel="stylesheet" />
    <!-- Skin -->
    <link href="Content/Skin/skin-blue.css" rel="stylesheet" />
    <!-- SpreadCSS -->
    <link href="Content/SpreadJS_CSS/gcspread.sheets.excel2016colorful.9.40.20161.0.css" rel="stylesheet" />

    <link href="Content/Tree/metroStyle.css" rel="stylesheet" />

</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to get the
desired effect
|---------------------------------------------------------|
| SKINS         | skin-blue                               |
|               | skin-black                              |
|               | skin-purple                             |
|               | skin-yellow                             |
|               | skin-red                                |
|               | skin-green                              |
|---------------------------------------------------------|
|LAYOUT OPTIONS | fixed                                   |
|               | layout-boxed                            |
|               | layout-top-nav                          |
|               | sidebar-collapse                        |
|               | sidebar-mini                            |
|---------------------------------------------------------|
-->
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

        <!-- Main Header -->
        <header class="main-header">

            <!-- Logo -->
            <a href="index2.html" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini">CNYD</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg">CNYD</span><!--<img src="Content/img/Logo.png">--> 
            </a>

            <!-- Header Navbar -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                </a>
                <!-- Navbar Right Menu -->
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">

                        <!-- User Account Menu -->
                        <li class="dropdown user user-menu">
                            <!-- Menu Toggle Button -->
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <!-- The user image in the navbar-->
                                <img src="Content/img/user2-160x160.jpg" class="user-image" alt="User Image">
                                <!-- hidden-xs hides the username on small devices so only the image appears. -->
                                <span class="hidden-xs">LG0452</span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- The user image in the menu -->
                                <li class="user-header">
                                    <img src="Content/img/user2-160x160.jpg" class="img-circle" alt="User Image">

                                    <p>
                                        Alexander Pierce - Web Developer
                                        <small>Member since Nov. 2012</small>
                                    </p>
                                </li>
                                <!-- Menu Body -->
                                <li class="user-body">
                                    <div class="row">
                                        <div class="col-xs-4 text-center">
                                            <a href="#">Followers</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="#">Sales</a>
                                        </div>
                                        <div class="col-xs-4 text-center">
                                            <a href="#">Friends</a>
                                        </div>
                                    </div>
                                    <!-- /.row -->
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="#" class="btn btn-default btn-flat">Profile</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="#" class="btn btn-default btn-flat">Sign out</a>
                                    </div>
                                </li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </nav>
        </header>
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">

            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">

                <!-- Sidebar user panel (optional) -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="Content/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                    </div>
                    <div class="pull-left info">
                        <p>LG0452</p>
                        <!-- Status -->
                        <a href="#"><i class="fa fa-circle text-success"></i> Login </a>
                    </div>
                </div>

                <!-- search form (Optional) -->
                <form action="#" method="get" class="sidebar-form">
                    <div class="input-group">
                        <input type="text" name="q" class="form-control" placeholder="Search...">
                        <span class="input-group-btn">
                            <button type="submit" name="search" id="search-btn" class="btn btn-flat">
                                <i class="fa fa-search"></i>
                            </button>
                        </span>
                    </div>
                </form>
                <!-- /.search form -->
                <!-- Sidebar Menu -->
                <ul class="sidebar-menu">
                    <li class="header">菜单</li>
                    <!-- Optionally, you can add icons to the links -->
                    <!--<li class="treeview">
                        <a href="#"><i class="fa fa-link"></i> <span>gLog</span> <i class="fa fa-angle-left pull-right"></i></a>
                        <ul class="treeview-menu">

                            <li><a href="#"><i class="fa fa-circle-o"></i> Level One</a></li>
                            <li>
                                <a href="#"><i class="fa fa-circle-o"></i> Level One <i class="fa fa-angle-left pull-right"></i></a>
                                <ul class="treeview-menu">
                                    <li><a href="#"><i class="fa fa-circle-o"></i> Level Two</a></li>
                                    <li>
                                        <a href="#"><i class="fa fa-circle-o"></i> Level Two <i class="fa fa-angle-left pull-right"></i></a>
                                        <ul class="treeview-menu">
                                            <li><a href="#"><i class="fa fa-circle-o"></i> Level Three</a></li>
                                            <li><a href="#"><i class="fa fa-circle-o"></i> Level Three</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><a href="#"><i class="fa fa-circle-o"></i> Level One</a></li>
                        </ul>
                    </li>-->
                    <li><a href="#"><i class="fa fa-linkedin"></i> <span>工程及结构任务</span></a>
                        <ul class="treeview-menu">
                            <li><a href="HtmlPage2.html"><i class="fa fa-circle-o"></i> 新建工程</a></li>
                            <li><a href="HtmlPage1.html"><i class="fa fa-circle-o"></i> TA分解</a></li>
                        </ul>
                    </li>
                    <li><a href="#"><i class="fa fa-dashboard"></i> <span>材料申请(设计)</span></a></li>
                    <li class="treeview">
                        <a href="#"><i class="fa fa-files-o"></i> <span>材料物流</span></a>
                        <ul class="treeview-menu">
                            <li><a href="HtmlPage2.html"><i class="fa fa-circle-o"></i> Create New CNYD Stillage</a></li>
                            <li><a href="HtmlPage1.html"><i class="fa fa-circle-o"></i> Edit New CNYD Stillage</a></li>
                            <li><a href="HtmlPage3.html"><i class="fa fa-circle-o"></i> Shipment Heade Information</a></li>
                            <li><a href="HtmlPage4.html"><i class="fa fa-circle-o"></i> Shipment Stillages</a></li>
                        </ul>
                    </li>
                    <li><a href="#"><i class="fa fa-th"></i> <span>材料采购及付款申请</span></a></li>
                    <li><a href="#"><i class="fa fa-pie-chart"></i> <span>Material Procurement</span></a></li>
                    <li><a href="#"><i class="fa fa-laptop"></i> <span>Site Logistics</span></a></li>
                    <li><a href="#"><i class="fa fa-edit"></i> <span>现场管理</span></a></li>
                    <li><a href="#"><i class="fa fa-table"></i> <span>工程管理(销售)</span></a></li>
                    <li><a href="#"><i class="fa fa-calendar"></i> <span>Project Mangement</span></a></li>
                    <li class="active"><a href="#"><i class="fa fa-envelope"></i> <span>其他</span></a></li>
                </ul>
                <!-- /.sidebar-menu -->
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <!--<section class="content-header">
                <h1>
                    钢材
                    <small>提料单</small>
                </h1>
                <ol class="breadcrumb">
                    <li><a href="#"><i class="fa fa-dashboard"></i> 提料单</a></li>
                    <li class="active">钢材</li>
                </ol>
            </section>-->

            <!-- Main content -->
            <section class="content">

                <!-- Your Page Content Here -->
                <!-- 主内容 -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="box box-primary">
                            <div class="box-header">
                                <h5>任务等级-代码</h5>
                            </div>
                            <div class="input-group  col-md-10" style="margin-left:10px ">
                                <input type="text" name="table_search" class="form-control pull-right" placeholder="查询">
                                <div class="input-group-btn">
                                    <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                                </div>
                            </div>
                            <div class="box-body box-profile">
                                <ul id="treeDemo" class="ztree"></ul>
                            </div>
                         </div>
                    </div>

                    <div class="col-md-9">
                        <div id="main_box" class="box box-primary direct-chat direct-chat-primary">
                            <div class="box-header">
                                <table>
                                    <tr>
                                        <td width="100px"><label class="control-label">T0304<span style="color:blue">07</span></label></td>
                                        <td width="90px" align="center" ><span style="font-size:14px">英文描述</span></td>
                                        <td width="200px"><input class="form-control input-sm" type="text" placeholder="英文描述"></td>
                                        <td width="300px" align="center"><span style="font-size:14px">(YE) Materialist to be completed:</span></td>
                                        <td width="180px"><input class="form-control input-sm" type="text" placeholder="(YE) Materialist to be completed:"></td>
                                        <td width="22%">
                                            <div class="btn-group" style='float:right;width: 180px;'>
                                                <button class="btn btn-info" type="button">Save</button>
                                                <button class="btn btn-info" type="button">Add</button>
                                                <button class="btn btn-info" type="button">Delete</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width ="70px"><label class="control-label"><span style="color:red">Finish</span></label></td>
                                        <td width="90px" align="center"><span style="font-size:14px">中文描述</span></td>
                                        <td width="200px"><input class="form-control input-sm" type="text" placeholder="中文描述"></td>
                                        <td width="300px" align="center"><span style="font-size:14px">(CNYO) Confirmed Date for Mat. List:</span></td>
                                        <td width="160px"><input class="form-control input-sm" type="text" placeholder="(CNYO) Confirmed Date for Mat. List:"></td>
                                        <td></td>
                                    </tr>
                                </table>
                            </div>
                            <!--<div><button id='Save' type="button" class="btn btn-block btn-info" style='width: 50px;'>保存</button></div>-->
                            <div id='MianSpread' style='width: 100%; height: 600px;'></div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
        <!-- Main Footer -->
        <footer class="main-footer">
            <!-- To the right -->
            <div class="pull-right hidden-xs">
                Anything you want
            </div>
            <!-- Default to the left -->
            <strong>Copyright &copy; 2015 <a href="#">Company</a>.</strong> All rights reserved.
        </footer>

        <!-- Control Sidebar -->

        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
             immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
    </div>
    <!-- ./wrapper -->
    <!-- REQUIRED JS SCRIPTS -->
    <!-- jQuery 2.2.0 -->

    <script src="Scripts/jQuery-2.2.0.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="Scripts/bootstrap.min.js"></script>
    <!-- AdminLTE App -->
    <script src="Scripts/dist/app.min.js"></script>
    <!-- Spreadjs -->
    <script src="Scripts/SpreadJS/gcspread.sheets.all.9.40.20161.0.min.js"></script>
    <script src="Scripts/SpreadJS/gcspread.sheets.print.9.40.20161.0.min.js"></script>
    <script src="Scripts/SpreadJS/gcspread.sheets.resources.zh.9.40.20161.0.min.js"></script>
    <!--jq 增强div resize-->
    <script src="Scripts/resize.js"></script>
    <!--ztree-->
    <script type="text/javascript" src="Scripts/TreeView/jquery.ztree.core.min.js"></script>
    <script type="text/javascript" src="Scripts/TreeView/jquery.ztree.excheck.js"></script>
    <script type="text/javascript" src="Scripts/TreeView/jquery.ztree.exedit.min.js"></script>
    <script type="text/javascript">

        var spread;
		$(
            function () {
            var spreadNS = GcSpread.Sheets;
            spread = new GcSpread.Sheets.Spread($('#MianSpread')[0], { sheetCount: 1 });
            var sheet = spread.getSheet(0);
            sheet.setColumnCount(9, GcSpread.Sheets.SheetArea.viewport);
            //列宽
            sheet.setColumnWidth(0, 80);
            sheet.setColumnWidth(1, 140);
            sheet.setColumnWidth(2, 140);
            sheet.setColumnWidth(3, 50);
            sheet.setColumnWidth(4, 50);
            sheet.setColumnWidth(5, 50);
            sheet.setColumnWidth(6, 100);
            sheet.setColumnWidth(7, 100);
            sheet.setColumnWidth(8, 100);
            //列头文本
            sheet.setValue(0, 0, "BT Code", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 1, "Description EN", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 2, "BT Description CN", GcSpread.Sheets.SheetArea.colHeader); 
            sheet.setValue(0, 3, "Units", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 4, "Qty.", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 5, "Drawing", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 6, "Comments", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 7, "Dimension", GcSpread.Sheets.SheetArea.colHeader);
            sheet.setValue(0, 8, "Specification", GcSpread.Sheets.SheetArea.colHeader);
            //var filter = sheet.rowFilter();
            //filter.filterButtonVisible(0, true);
            //获取行数
            var count = sheet.getRowCount(GcSpread.Sheets.SheetArea.viewport);
            //设置筛选
            var filter = new spreadNS.HideRowFilter(new spreadNS.Range(0, 0, count, 9));
            sheet.rowFilter(filter);
            $('#main_box').resize(function () {
                spread.refresh();
            });
            $.fn.zTree.init($("#treeDemo"), setting, zNodes);
        });
        
		var setting = {
		    view: {
		        //addHoverDom: addHoverDom,
		        //removeHoverDom: removeHoverDom,
		        selectedMulti: false
		    }
		    //,check: {
		    //    enable: true
		    //}
		    ,data: {
		        simpleData: {
		            enable: true
		        }
		    }
		    //,edit: {
		    //    enable: true
		    //}
		};

		var newCount = 1;
		function addHoverDom(treeId, treeNode) {
		    var sObj = $("#" + treeNode.tId + "_span");
		    if (treeNode.editNameFlag || $("#addBtn_" + treeNode.tId).length > 0) return;
		    var addStr = "<span class='button add' id='addBtn_" + treeNode.tId
                + "' title='add node' onfocus='this.blur();'></span>";
		    sObj.after(addStr);
		    var btn = $("#addBtn_" + treeNode.tId);
		    if (btn) btn.bind("click", function () {
		        var zTree = $.fn.zTree.getZTreeObj("treeDemo");
		        zTree.addNodes(treeNode, { id: (100 + newCount), pId: treeNode.id, name: "new node" + (newCount++) });
		        return false;
		    });
		};
		function removeHoverDom(treeId, treeNode) {
		    $("#addBtn_" + treeNode.tId).unbind().remove();
		};

		var zNodes = [
            { id: 1, pId: 0, name: "Hotel", open: true },
            { id: 11, pId: 1, name: "Special" },
            { id: 111, pId: 11, name: "..." },
            { id: 112, pId: 11, name: "Orthers" },
            { id: 1111, pId: 111, name: "T0203 03 SKirt Steel T0203" },
            { id: 1112, pId: 111, name: "T0203 03 SKirt Steel T0203" },
            { id: 12, pId: 1, name: "父节点12" },
            { id: 121, pId: 12, name: "叶子节点121" },
            { id: 122, pId: 12, name: "叶子节点122" },
            { id: 123, pId: 12, name: "叶子节点123" },
            { id: 124, pId: 12, name: "叶子节点124" },
            { id: 13, pId: 1, name: "父节点13", isParent: true },
            { id: 2, pId: 0, name: "父节点2" },
            { id: 21, pId: 2, name: "父节点21", open: true },
            { id: 211, pId: 21, name: "叶子节点211" },
            { id: 212, pId: 21, name: "叶子节点212" },
            { id: 213, pId: 21, name: "叶子节点213" },
            { id: 214, pId: 21, name: "叶子节点214" },
            { id: 22, pId: 2, name: "父节点22" },
            { id: 221, pId: 22, name: "叶子节点221" },
            { id: 222, pId: 22, name: "叶子节点222" },
            { id: 223, pId: 22, name: "叶子节点223" },
            { id: 224, pId: 22, name: "叶子节点224" },
            { id: 23, pId: 2, name: "父节点23" },
            { id: 231, pId: 23, name: "叶子节点231" },
            { id: 232, pId: 23, name: "叶子节点232" },
            { id: 233, pId: 23, name: "叶子节点233" },
            { id: 234, pId: 23, name: "叶子节点234" },
            { id: 3, pId: 0, name: "父节点3", isParent: true }
		];

		var defaultData = [
          {
              text: 'Measuered Works',href: '#parent1',tags: ['4'],
              nodes: [{text: 'Hotel',href: '#child1',tags: ['2'],
                        nodes: [
                          {
                              text: 'Special',
                              href: '#grandchild1',
                              tags: ['0']
                          },
                          {
                              text: 'Foyer',
                              href: '#grandchild2',
                              tags: ['0'],
                              nodes: [
                                {
                                    text: 'T0203 03 SKirt Steel'
                                },
                                {
                                    text: 'T0204 03 Ext. incl'
                                },
                                {
                                    text: 'T0224 03 SKirt Panels'
                                },
                                {
                                    text: 'T0224 04 SKirt Panels'
                                },
                                {
                                    text: 'T0224 05 SKirt Panels'
                                },
                                {
                                    text: 'T0224 06 SKirt Panels'
                                },
                              ]
                          },
                          {
                              text: 'Cavity',
                              href: '#grandchild3',
                              tags: ['0']
                          },
                          {
                              text: 'Internal',
                              href: '#grandchild3',
                              tags: ['0']
                          },
                          {
                              text: 'Doors',
                              href: '#grandchild3',
                              tags: ['0']
                          }]
                    },
                    {text: 'Tower-Foyer',href: '#child2',tags: ['0']
                    }
                  ]
              }
		];
		$('#treeview4').treeview({
		    color: "#428bca",
		    data: defaultData
		});
    </script>
</body>
</html>
